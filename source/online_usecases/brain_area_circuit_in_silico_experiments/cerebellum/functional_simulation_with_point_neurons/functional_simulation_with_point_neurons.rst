########################################
Functional Simulation with Point Neurons
########################################

Expert: Stefano Casali, Elisa Marenzi, Claudia Casellato
Target audience: (medium) Power Users 
Target interface: Notebook 

This use case can be used to test the functionality of the cerebellar microcircuit, into NEST environment. 
The use case is integrated with NIP and can be found in *Online Use Cases/Brain area circuit in silico experiments/Cerebellum/Functional simulation with point neurons*.

     .. image:: images/schema.tif
        :width: 373px

     .. image:: images/functional_flow_chart.tif
        :width: 1612px
 
Approach: in pyNEST a network is built following the specificity generated by “Cell positioning” and “connectome”. The network can then be run (using HPC by UNICORE) imposing input stimulation patterns on specific neurons at input stage.
Each neuron is created as a spiking neuron using IAF dynamics with conductance-based synapses, with parameters specific for each neuron type. The pairwise connections are created and tuned in a simplified way (weight positive/negative and delay). An input pattern is defined on glomeruli; the simulation runs, and then the spiking activity of all neurons (neuron ID and spike times) is recorded and stored.
The network spiking dynamics can be investigated by estimating population frequency-related parameters.

Inputs: 
•	.dat matrices (saved in /storage) from the “Cell positioning” use case (in Online Use Cases/Circuit Building/Cerebellum/Cell positioning) and the “connectome” use case (in Online Use Cases/Circuit Building/Cerebellum/Connectome) and the relative parameters used for that generation imported from scaffold_params.py (in /storage)

For expert users, “stimulation input patterns” could be modified into the code

Output: 
•	Spike times of each network neuron along the simulation duration (.gdf on local path on HPC). The user can choose whether transfer those files into the Collab storage (by code box into the notebook)
•	Monitoring: frequency and PSTH of each neuron type population 

Steps:
•	Running all notebook steps one at a time 
•	Running each step in a sequential order

Additional information:
•	The whole usecase should take about 4.5 hours (with 8192 cores (512 nodes) on Juqueen) for a volume base of 200 x 200 µm, excluding queue-time and excluding the a-posteriori “spike analysis”. 
•	login to HPC resource by UNICORE

Used BBP tools in notebook directly:
•	pyNEST


Details for each neuron model in the pyNEST network
Main ref from neuroelectro.org

     .. image:: images/table.tif
        :width: 1005px


EXAMPLE

A volume of:
o	x = 200 µm, z = 200 µm (→ DCN  100 x 100 µm)
o	y = 930 µm (600+150+30+150  µm), i.e. thickness DCN + GRL+ PCL + ML

THUS with  24157# NUMBER of PLACED NEURONS and 634165# of  GENERATED PAIRWISE CONNECTIONS, the PSTH for GOLGI CELLS SPIKES is:

     .. image:: images/output.tif
        :width: 1005px

		
