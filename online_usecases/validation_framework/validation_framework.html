


<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HBP Validation Framework Platform &#8212; HBP Brain Simulation Platform Guidebook 0.1.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/hbpdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bsp.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bsp.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/extra.js"></script>
    <script type="text/javascript" src="../../_static/hbpdoc.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Deliverables" href="../../deliverables/deliverables.html" />
    <link rel="prev" title="Analyze an optimization run" href="../single_cell_building/hippocampus/analyze_run.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">

  </head>
  <body role="document">
<div class="hbpdoc-page">
    <section class="hbpdoc-title page-header">
        <a class="project-title" href="../../index.html">HBP Brain Simulation Platform Guidebook</a>

        <a class="hbpdoc-toc-toggle pull-right" href>
            <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
        </a>
    </section>
    <section class="hbpdoc-main">
        <nav class="hbpdoc-sidebar hbpdoc-container">
            <a class="hbpdoc-toc-toggle pull-right" href>
                <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
            </a>
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">HBP Validation Framework Platform</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#choosing-and-loading-a-model-from-the-hvf-model-catalog">Choosing and loading a model from the HVF Model Catalog</a></li>
<li><a class="reference internal" href="#choosing-and-loading-a-desired-validation-test">Choosing and loading a desired Validation Test</a></li>
<li><a class="reference internal" href="#running-the-desired-validation-test-on-the-chosen-model">Running the desired Validation Test on the chosen model</a></li>
<li><a class="reference internal" href="#storing-the-data-of-the-validation-test-results">Storing the data of the Validation Test Results</a></li>
<li><a class="reference internal" href="#registering-the-validation-test-result">Registering the Validation Test Result</a></li>
<li><a class="reference internal" href="#all-the-preceding-steps-in-a-script">All the preceding steps in a script</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../single_cell_building/hippocampus/analyze_run.html"
                        title="previous chapter">Analyze an optimization run</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../deliverables/deliverables.html"
                        title="next chapter">Deliverables</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/online_usecases/validation_framework/validation_framework.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </nav>

        <article class="hbpdoc-content">

            <div class="content">
                
                <div class="breadcrumb breadcrumb-meta expand">
                    
                    <a href="../online_usecases.html">Online Use Cases</a>
                    
                </div>
                

                <aside class="hbpdoc-hnav hbpdoc-hnav-top">
                    
                    <span class="hbpdoc-hnav-previous">
                        previous: <a class="hbpdoc-hnav-link" href="../single_cell_building/hippocampus/analyze_run.html">Analyze an optimization run</a>
                    </span>
                    
                    
                    <span class="hbpdoc-hnav-next">
                        next: <a class="hbpdoc-hnav-link" href="../../deliverables/deliverables.html">Deliverables</a>
                    </span>
                    
                </aside>

                <div class="section" id="hbp-validation-framework-platform">
<span id="validation-framework"></span><h1>HBP Validation Framework Platform<a class="headerlink" href="#hbp-validation-framework-platform" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<span id="vfp-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>At current stage of development of the <a class="reference external" href="https://validation.brainsimulation.eu/">HVF platform</a>, the framework is accessible via client and it will be possible to access through an app in the future. Therefore, this quick-guide will demonstrate how a user can access from a client (python client or jupyter notebook). The jupyter notebook will be used to illustrate this.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Purpose</strong></p>
<p>A user visits the HVF platform (see figure below). The user then choses <a class="reference internal" href="#choosing-loading-model"><span class="std std-ref">a model</span></a> to validate and the <a class="reference internal" href="#choosing-loading-test"><span class="std std-ref">desired validation test</span></a>. After this the user <a class="reference internal" href="#running-validation-test"><span class="std std-ref">runs</span></a> the validation test. The data of the test result is <a class="reference internal" href="#storing-data-results"><span class="std std-ref">stored</span></a>. The result and the data location is <a class="reference internal" href="#registering-validation-test"><span class="std std-ref">registered</span></a> in the HVF database.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/vuc_home.png"><img alt="../../_images/vuc_home.png" class="align-right" src="../../_images/vuc_home.png" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Background</strong></p>
<p>Before diving into the steps, one necessary condition is to install the HVF platform. This is done as follows (see also video below)</p>
<p><strong>!pip install https://github.com/apdavison/hbp-validation-client/archive/master.zip</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/installhbpvalidframework.gif"><img alt="../../_images/installhbpvalidframework.gif" class="align-right" src="../../_images/installhbpvalidframework.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="choosing-and-loading-a-model-from-the-hvf-model-catalog">
<span id="choosing-loading-model"></span><h2>Choosing and loading a model from the HVF Model Catalog<a class="headerlink" href="#choosing-and-loading-a-model-from-the-hvf-model-catalog" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Purpose</strong></p>
<p>In the HVF, user checks out the model catalog containing the list of currently available models for validations. The user then picks a model (see video below).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/HVF_Model.gif"><img alt="../../_images/HVF_Model.gif" class="align-right" src="../../_images/HVF_Model.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Background</strong></p>
<p>The platform has metadata about the model. For example, the model CA_Bianchi a pyramidal cell model of hippocampus CA1 region. The model is versioned and is located in <a class="reference external" href="https://github.com/apdavison/hippocampus_CA1_pyramidal">https://github.com/apdavison/hippocampus_CA1_pyramidal</a>.</p>
<p>To proceed let&#8217;s say our</p>
<blockquote>
<div><ul class="simple">
<li><strong>chosen model: CA1_Bianchi</strong></li>
<li><strong>model location: https://github.com/apdavison/hippocampus_CA1_pyramidal</strong></li>
</ul>
</div></blockquote>
<p><strong>How to.</strong></p>
<p>The user will need to load the CA1_Bianchi that he/she intends to validate. To load the model, it must be first cloned into a directory. In the jupyter notebook this is done with the command</p>
<p><strong>&gt;&gt; !git clone https://github.com/apdavison/hippocampus_CA1_pyramidal</strong></p>
<p>This will create a subdirectory. The user then goes into this directory and import the models.</p>
<p>This additional step is not essential to run the validation test. But if the user wants to confirm that the chosen CA1_Bianchi model is available in the module, this is done as follows (see also the video below):</p>
<p><strong>&gt;&gt; import inspect</strong></p>
<p><strong>&gt;&gt; [m[0] for m in inspect.getmembers(models, inspect.isclass) if m[1].__module__ == &#8220;models&#8221;]</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/loadModel.gif"><img alt="../../_images/loadModel.gif" class="align-right" src="../../_images/loadModel.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="choosing-and-loading-a-desired-validation-test">
<span id="choosing-loading-test"></span><h2>Choosing and loading a desired Validation Test<a class="headerlink" href="#choosing-and-loading-a-desired-validation-test" title="Permalink to this headline">¶</a></h2>
<p><strong>Purpose</strong></p>
<p>The user has chosen a model. From a list of validation tests, the user then chooses a validation test.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/HVF_Test.gif"><img alt="../../_images/HVF_Test.gif" class="align-right" src="../../_images/HVF_Test.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Background</strong></p>
<p>The platform has metadata about what family of models the test is suitable for, the location of the experimental data against which the model will be validated and the repository location of the test.</p>
<p>A test definition in the HVF comprises:</p>
<blockquote>
<div><ul class="simple">
<li><strong>location of the coded test function</strong></li>
<li><strong>location of the experimental data</strong></li>
</ul>
</div></blockquote>
<p>Test definitions can be obtained through the test URI (preferably JSON form).</p>
<p>For the chosen CA1_Bianchi model let&#8217;s say we have the following:</p>
<blockquote>
<div><ul class="simple">
<li><strong>desired test: Depolarization Block test</strong></li>
<li><strong>location: https://github.com/apdavison/hippounit</strong></li>
</ul>
</div></blockquote>
<p><strong>How to.</strong></p>
<p>The chosen model is a hippocampus CA1 pyramidal cell model. Therefore based on the metadata we should be able to run our desired depolarization block test.</p>
<p>As with loading the model, the user loads the desired validation test. That is, load the test definition from the URI (JSON form). This is done as follows (see also the video below):</p>
<p><strong>&gt;&gt; desired_test_uri = &#8220;https://validation.brainsimulation.eu/tests/1&#8221;</strong></p>
<p><strong>&gt;&gt; from hbp_validation_framework import ValidationTestLibrary</strong></p>
<p><strong>&gt;&gt; test_library = ValidationTestLibrary(username=&#8221;lungsi&#8221;)</strong></p>
<p><strong>&gt;&gt; test = test_library.get_validation_test(desired_test_uri)</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/loadTest.gif"><img alt="../../_images/loadTest.gif" class="align-right" src="../../_images/loadTest.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="running-the-desired-validation-test-on-the-chosen-model">
<span id="running-validation-test"></span><h2>Running the desired Validation Test on the chosen model<a class="headerlink" href="#running-the-desired-validation-test-on-the-chosen-model" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Purpose</strong></p>
<p>Run the desired validation test on the chosen model.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>How to.</strong></p>
<p>To run the following:</p>
<blockquote>
<div><ul class="simple">
<li><strong>desired validation test: Depolarization block test</strong></li>
<li><strong>chosen model: Bianchi CA1 pyramidal cell</strong></li>
</ul>
</div></blockquote>
<p>the command is typed as follows (see also the videos below):</p>
<p><strong>&gt;&gt; score = test.judge(getattr(models, &#8216;Bianchi&#8217;)(), deep_error=True)</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/runTest.gif"><img alt="../../_images/runTest.gif" class="align-right" src="../../_images/runTest.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/runTest2.gif"><img alt="../../_images/runTest2.gif" class="align-right" src="../../_images/runTest2.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="storing-the-data-of-the-validation-test-results">
<span id="storing-data-results"></span><h2>Storing the data of the Validation Test Results<a class="headerlink" href="#storing-the-data-of-the-validation-test-results" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Purpose</strong></p>
<p>Store the data of the results after running the desired validation test on the chosen model.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>How to.</strong></p>
<p>To store the results data of our test run on the collab storage do the following (see also the video below):</p>
<p><strong>&gt;&gt; from hbp_validation_framework.datastores import CollabDataStore</strong></p>
<p><strong>&gt;&gt; collab_storage = CollabDataStore(username=&#8221;lungsi&#8221;, collab_id=&#8221;1655&#8221;, base_folder=&#8221;VUC_Bianchi_DepolTest_results&#8221;)</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/storeResults.gif"><img alt="../../_images/storeResults.gif" class="align-right" src="../../_images/storeResults.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The above command stores the results files in the directory named VUC_Bianchi_DepolTest_results of BSP collab (1655 id) storage. This is shown in the video below.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/storeResultsCollab.gif"><img alt="../../_images/storeResultsCollab.gif" class="align-right" src="../../_images/storeResultsCollab.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="registering-the-validation-test-result">
<span id="registering-validation-test"></span><h2>Registering the Validation Test Result<a class="headerlink" href="#registering-the-validation-test-result" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Purpose</strong></p>
<p>Register the results data.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>How to.</strong></p>
<p>It is recommended that the results data are registered. To register the data do (see also video below):</p>
<p><strong>&gt;&gt; test_library.register(score, collab_storage)</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/registerResults.gif"><img alt="../../_images/registerResults.gif" class="align-right" src="../../_images/registerResults.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Below we illustrate the result being registered in the test results database of the framework.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/HVF_Results.gif"><img alt="../../_images/HVF_Results.gif" class="align-right" src="../../_images/HVF_Results.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="all-the-preceding-steps-in-a-script">
<span id="all-preceding-steps"></span><h2>All the preceding steps in a script<a class="headerlink" href="#all-the-preceding-steps-in-a-script" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Purpose</strong></p>
<p>Run the desired validation on the chosen model from a script.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>How to.</strong></p>
<p>There are various ways of writing a script. Here is one version of a python script.</p>
<p><strong>import argparse</strong></p>
<p><strong>import inspect</strong></p>
<p><strong>import models</strong></p>
<p><strong>from hbp_validation_framework import ValidationTestLibrary</strong></p>
<p><strong>from hbp_validation_framework.datastores import CollabDataStore</strong></p>
<p><strong>#</strong></p>
<p><strong># Parses command line arguments</strong></p>
<p><strong>parser = argparse.ArgumentParser(&#8220;Process model to be validated against the URI of the v-test.&#8221;)</strong></p>
<p><strong>parser.add_argument ( &#8220;&#8211;modelName&#8221;, help=&#8221;A model name from hippocampus_CA1_pyramidal&#8221;, choices= [m[0] for m in inspect.getmembers(models, inspect.isclass) if m[1].__module__ == &#8216;models&#8217;])</strong></p>
<p><strong>parser.add_argument(&#8220;&#8211;testURI&#8221;, help=&#8221;local path to the v-test&#8221;)</strong></p>
<p><strong>parser.add_argument(&#8220;&#8211;userName&#8221;, default=&#8221;lungsi&#8221;, help=&#8221;Give a username (default: lungsi)&#8221;) parser.add_argument(&#8220;&#8211;collabID&#8221;, default=&#8221;1655&#8221;, help=&#8221;The number of the collab (default: 1655)&#8221;)</strong></p>
<p><strong>parser.add_argument(&#8220;&#8211;folderName&#8221;, default=&#8221;VUC_modelName_testName_results&#8221;, help=&#8221;Give the folder name (default: VUC_modelName_testName_results)&#8221;)</strong></p>
<p><strong>args = parser.parse_args()</strong></p>
<p><strong>#</strong></p>
<p><strong># Load the model</strong></p>
<p><strong>model = getattr(models, args.modelName)()</strong></p>
<p><strong>#</strong></p>
<p><strong># Load the test</strong></p>
<p><strong>desired_test_uri = args.testURI test_library = ValidationTestLibrary(username = args.userName) test = test_library.get_validation_test(desired_test_uri, show_plot=True) score = test.judge(model, deep_error=True)</strong></p>
<p><strong>#</strong></p>
<p><strong># Store the results</strong></p>
<p><strong>collab_storage = CollabDataStore(username = args.userName, collab_id = args.collabID, base_folder = args.folderName)</strong></p>
<p>If you are working from a terminal, to copy-paste the below code you first need to have a .py file (here runTests.py). One way to do this in jupyter notebook is</p>
<p><strong>&gt;&gt; %%writefile runTests.py -a</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/writeScript.gif"><img alt="../../_images/writeScript.gif" class="align-right" src="../../_images/writeScript.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>To run this runTests.py script from the jupyter notebook you can use the help feature.</p>
<p><strong>&gt;&gt; %run runTests.py -h</strong></p>
<p>You can than run the depolarization block test on the chosen CA1_Bianchi model as shown below</p>
<p><strong>&gt;&gt; %run runTests.py &#8211;modelName Bianchi &#8211;testURI https://valiation.brainsimulation.eu/tests/1</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../_images/runScript.gif"><img alt="../../_images/runScript.gif" class="align-right" src="../../_images/runScript.gif" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>

            </div>

            <aside class="hbpdoc-hnav hbpdoc-hnav-bottom">
                
                <span class="hbpdoc-hnav-previous">
                    previous: <a class="hbpdoc-hnav-link" href="../single_cell_building/hippocampus/analyze_run.html">Analyze an optimization run</a>
                </span>
                
                
                <span class="hbpdoc-hnav-next">
                    next: <a class="hbpdoc-hnav-link" href="../../deliverables/deliverables.html">Deliverables</a>
                </span>
                
            </aside>
        </article>
    </section>


    <div class="hbpdoc-footer">
        HBP Brain Simulation Platform Guidebook <small>0.1</small> 
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Luca L. Bologna, Carmen A. Lupascu, R. Migliore, M. Migliore.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
    </div>
</div>

  </body>
</html>